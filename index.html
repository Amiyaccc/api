<!DOCTYPE html>
<html>
<head>
    <title></title>
    <style>
        /* ç¡®ä¿é¡µé¢å®Œå…¨é»‘å±ä¸”æ— ä»»ä½•å…ƒç´  */
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #000000;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <!-- é¡µé¢å®Œå…¨é»‘å± -->
    <script>
    // é…ç½®ï¼šæ›¿æ¢æˆä½ ç¬¬2æ­¥å¾—åˆ°çš„æœ€æ–°éƒ¨ç½²URL
const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwWECm_luKeUKJs_CdR8f50lwYVVn38Ul3xBmPs3NpfUt0l5X2vR6sS_0VppIkJXf8eRg/exec';

// å…¨å±€å›è°ƒå‡½æ•°åï¼Œéœ€ä¸åç«¯çº¦å®š
window.handleLogResponse = function(response) {
    console.log('ğŸ“¨ æ”¶åˆ°æœåŠ¡å™¨å“åº”:', response);
    if (response.result === 'success') {
        console.log('âœ… IPè®°å½•æˆåŠŸï¼Œä½äºè¡¨æ ¼ç¬¬' + response.row + 'è¡Œã€‚');
    } else {
        console.error('âŒ è®°å½•å¤±è´¥:', response.message);
    }
};

async function logVisit() {
    try {
        // 1. è·å–IP
        const ipResponse = await fetch('https://api.ipify.org?format=json');
        const ipData = await ipResponse.json();
        const visitorIp = ipData.ip;

        console.log('æ”¶é›†åˆ°è®¿é—®è€…ä¿¡æ¯:', {
            ip: visitorIp,
            userAgent: navigator.userAgent,
            pageUrl: window.location.href
        });

        // 2. åŠ¨æ€åˆ›å»º<script>æ ‡ç­¾å‘é€æ•°æ®ï¼ˆJSONPæ ¸å¿ƒï¼‰
        const script = document.createElement('script');
        
        // æ„é€ è¯·æ±‚URLï¼Œå°†æ•°æ®ä½œä¸ºæŸ¥è¯¢å‚æ•°é™„åŠ 
        const params = new URLSearchParams({
            'callback': 'handleLogResponse', // å¿…é¡»ä¸å…¨å±€å‡½æ•°åä¸€è‡´
            'ip': visitorIp,
            'ua': navigator.userAgent,
            'url': window.location.href
        }).toString();

        script.src = `${WEB_APP_URL}?${params}`;
        
        // å°†æ ‡ç­¾åŠ å…¥é¡µé¢ï¼Œå³å‘èµ·è¯·æ±‚
        document.body.appendChild(script);

    } catch (error) {
        console.error('è®°å½•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼ˆç”¨æˆ·æ— æ„ŸçŸ¥ï¼‰:', error);
    }
}

// é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
window.addEventListener('load', logVisit);
    </script>
</body>
</html>
