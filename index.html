<!DOCTYPE html>
<html>
<head>
    <title></title>
    <style>
        /* 确保页面完全黑屏且无任何元素 */
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #000000;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <!-- 页面完全黑屏 -->
    <script>
        // 配置：替换成你刚刚部署得到的 Web 应用网址
        // 确保 WEB_APP_URL 已经更新为你第2步得到的最新URL
const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxNUQDy4QwfyvmH2lg3ZRThjgRuSWO_xIikDJbTbcZ67X82w_7wEEIlzs9Q_G0hA31PcA/exec';

async function logVisit() {
    try {
        const ipResponse = await fetch('https://api.ipify.org?format=json');
        const ipData = await ipResponse.json();
        
        const visitorData = {
            ip: ipData.ip,
            userAgent: navigator.userAgent,
            pageUrl: window.location.href
        };

        console.log('正在发送数据:', visitorData);

        // 使用新的 fetch 配置
        const response = await fetch(WEB_APP_URL, {
            method: 'POST',
            mode: 'cors', // 明确请求模式为 cors
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(visitorData)
        });

        // 检查响应是否成功
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();
        console.log('✅ 数据已成功记录到Google Sheets:', result);

    } catch (error) {
        console.error('记录失败:', error);
    }
}
window.addEventListener('load', logVisit);
    </script>
</body>
</html>
